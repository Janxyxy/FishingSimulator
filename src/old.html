<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>

        app.get("/api/creation_date", (req, res) => {
            if (!req.session || !req.session.username) {
                res.sendFile(path.join(__dirname, "src", "401page.html"));
                return;
            }
            const selectQuery = "SELECT creation_date FROM users WHERE id = ?";
            connection.query(
                selectQuery,
                [req.session.userId],
                (error, results, fields) => {
                    if (error) {
                        res
                            .status(500)
                            .send(
                                "Error retrieving creation date from database: " + error.message
                            );
                        return;
                    }
                    res.json(results);
                }
            );
        });
        app.get("/api/last_update_time", (req, res) => {
            if (!req.session || !req.session.username) {
                res.sendFile(path.join(__dirname, "src", "401page.html"));
                return;
            }
            const selectQuery = "SELECT last_update_time FROM users WHERE id = ?";
            connection.query(
                selectQuery,
                [req.session.userId],
                (error, results, fields) => {
                    if (error) {
                        res
                            .status(500)
                            .send(
                                "Error retrieving creation date from database: " + error.message
                            );
                        return;
                    }
                    res.json(results);
                }
            );
        });

        app.get("/api/username", (req, res) => {
            if (!req.session || !req.session.username) {
                res.sendFile(path.join(__dirname, "src", "401page.html"));
                return;
            }
            res.json({ username: req.session.username });
        });

        app.get("/api/userId", (req, res) => {
            if (!req.session || !req.session.userId) {
                res.sendFile(path.join(__dirname, "src", "401page.html"));
                return;
            }
            res.json({ userId: req.session.userId });
        });
    </script>
</body>

</html>